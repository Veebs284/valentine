<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pujarini's Flowers</title>
  <style>
    html, body { margin:0; height:100%; overflow:hidden; }
    canvas { display:block; width:100vw; height:100vh; }

    /* Move message higher (sky) */
    .overlay{
      position: fixed;
      top: 12%;
      left: 0;
      width: 100%;
      display:flex;
      justify-content:center;
      pointer-events:none;
      padding: 0 18px;
      z-index: 2;
    }
    .card{
      text-align:center;
      padding: 18px 22px;
      border-radius: 18px;
      backdrop-filter: blur(10px);
      background: rgba(255,255,255,0.35);
      border: 1px solid rgba(255,255,255,0.35);
      box-shadow: 0 10px 30px rgba(0,0,0,0.18);
      max-width: 680px;
    }
    h1{
      margin: 0 0 6px 0;
      font-family: ui-serif, Georgia, "Times New Roman", Times, serif;
      font-weight: 800;
      letter-spacing: 0.5px;
      font-size: clamp(32px, 5vw, 56px);
      color: #d6336c;
      text-shadow: 0 10px 30px rgba(255,255,255,0.35);
    }
    p{
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      font-size: clamp(16px, 2.4vw, 24px);
      color: #2f2f2f;
    }
    .hint{
      position: fixed;
      bottom: 14px;
      left: 50%;
      transform: translateX(-50%);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      font-size: 13px;
      color: rgba(0,0,0,0.55);
      background: rgba(255,255,255,0.42);
      border: 1px solid rgba(255,255,255,0.55);
      padding: 8px 12px;
      border-radius: 999px;
      backdrop-filter: blur(10px);
      z-index: 2;
    }
  </style>
</head>
<body>
  <canvas id="c"></canvas>

  <div class="overlay">
    <div class="card">
      <h1>PUCHKUUUU!!! ❤️</h1>
      <p>Happy Valentine’s Day!</p>
    </div>
  </div>
  <div class="hint">Tip: click/tap to grow more flowers ✨</div>

<script>
(() => {
  const canvas = document.getElementById('c');
  const ctx = canvas.getContext('2d', { alpha: false });

  // --- HiDPI resize ---
  function resize() {
    const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
    canvas.width = Math.floor(innerWidth * dpr);
    canvas.height = Math.floor(innerHeight * dpr);
    canvas.style.width = innerWidth + "px";
    canvas.style.height = innerHeight + "px";
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);

    // keep clouds within new bounds after resize
    for (const c of (clouds || [])) {
      c.x = clamp(c.x, -200, innerWidth + 200);
      c.y = clamp(c.y, innerHeight * 0.05, innerHeight * 0.42);
    }
  }
  addEventListener('resize', resize, { passive: true });

  // --- Helpers ---
  const rand = (a,b)=>a+Math.random()*(b-a);
  const clamp = (v,a,b)=>Math.max(a,Math.min(b,v));
  const lerp = (a,b,t)=>a+(b-a)*t;

  // Summer day sky background
  function paintBackground() {
    const w = innerWidth, h = innerHeight;

    // Blue sky gradient
    const g = ctx.createLinearGradient(0, 0, 0, h);
    g.addColorStop(0, '#87CEEB');   // sky blue
    g.addColorStop(0.6, '#bde9ff'); // light sky
    g.addColorStop(1, '#e6f7ff');   // near horizon
    ctx.fillStyle = g;
    ctx.fillRect(0, 0, w, h);

    // Soft sun glow
    const sun = ctx.createRadialGradient(w*0.85, h*0.15, 20, w*0.85, h*0.15, 180);
    sun.addColorStop(0, 'rgba(255,255,200,0.9)');
    sun.addColorStop(0.4, 'rgba(255,255,200,0.4)');
    sun.addColorStop(1, 'rgba(255,255,200,0)');
    ctx.fillStyle = sun;
    ctx.fillRect(0, 0, w, h);
  }

  // --- Flower model ---
  const flowers = [];
  const MAX_FLOWERS = 170;

  // Palettes (petals)
  const palettes = [
    ['#ff5aa5', '#ff87c2', '#ffd1e6'],
    ['#ffcf5a', '#ffe08a', '#fff0c7'],
    ['#7ae7ff', '#a6f2ff', '#e0fbff'],
    ['#b07bff', '#d1b1ff', '#f0e7ff'],
    ['#ff6b6b', '#ff9a9a', '#ffe0e0'],
    ['#66ffb3', '#8fffc8', '#d6ffe9'],
  ];

  function spawnFlower(x = rand(0, innerWidth), y = innerHeight) {
    if (flowers.length >= MAX_FLOWERS) flowers.shift();

    const horizon = innerHeight * 0.62;
    const gy = rand(horizon, innerHeight * 0.98);
    const depth = (gy - horizon) / (innerHeight - horizon); // 0..1
    const scale = lerp(0.45, 1.2, depth);

    const stemLen = rand(80, 220) * scale;
    const stemWidth = rand(2.2, 4.2) * scale;
    const swayAmp = rand(8, 28) * scale;
    const swaySpeed = rand(0.6, 1.3);

    const petalCount = Math.round(rand(6, 12));
    const petalLen = rand(16, 34) * scale;
    const petalWid = rand(9, 18) * scale;

    const palette = palettes[Math.floor(rand(0, palettes.length))];
    const petalA = palette[0];
    const petalB = palette[1];
    const petalC = palette[2];

    const centerColor = (Math.random() < 0.5) ? '#ffe08a' : '#fff3b0';

    flowers.push({
      x,
      baseY: gy,
      stemLen,
      stemWidth,
      swayAmp,
      swaySpeed,
      phase: rand(0, Math.PI * 2),
      growth: 0,
      bloom: 0,
      petalCount,
      petalLen,
      petalWid,
      petalA, petalB, petalC,
      centerColor,
      leafT: rand(0.25, 0.65),
      leafSize: rand(14, 26) * scale,
      scale,
      z: depth
    });

    flowers.sort((a,b)=>a.z-b.z);
  }

  // Seed initial field
  for (let i=0;i<95;i++) spawnFlower(rand(0, innerWidth));

  // Add on click/tap (grow cluster)
  function burstAt(px, py) {
    const n = 10;
    for (let i=0;i<n;i++) {
      const x = px + rand(-70, 70);
      spawnFlower(clamp(x, 0, innerWidth), py);
    }
  }
  addEventListener('pointerdown', (e) => {
    burstAt(e.clientX, e.clientY);
  }, { passive: true });

  // --- Drawing primitives ---
  function drawStem(f, t, time) {
    const len = f.stemLen * t;
    const sway = Math.sin(time * f.swaySpeed + f.phase) * f.swayAmp * (0.35 + 0.65*t);

    const x0 = f.x;
    const y0 = f.baseY;
    const x1 = x0 + sway;
    const y1 = y0 - len;

    const cx = lerp(x0, x1, 0.5) + sway * 0.25;
    const cy = y0 - len * 0.55;

    const g = ctx.createLinearGradient(x0, y0, x1, y1);
    g.addColorStop(0, 'rgba(36, 130, 92, 0.95)');
    g.addColorStop(1, 'rgba(120, 220, 160, 0.95)');

    ctx.strokeStyle = g;
    ctx.lineWidth = f.stemWidth;
    ctx.lineCap = 'round';
    ctx.beginPath();
    ctx.moveTo(x0, y0);
    ctx.quadraticCurveTo(cx, cy, x1, y1);
    ctx.stroke();

    const leafAt = f.leafT;
    const lx = lerp(x0, x1, leafAt);
    const ly = lerp(y0, y1, leafAt);
    const ldir = Math.sin(time*f.swaySpeed + f.phase + 1.6) > 0 ? 1 : -1;
    const leafS = f.leafSize * (0.25 + 0.75*t);

    drawLeaf(lx, ly, ldir, leafS, time, f.phase);

    return { tipX: x1, tipY: y1 };
  }

  function drawLeaf(x, y, dir, size, time, phase) {
    const wob = Math.sin(time*1.1 + phase) * 0.25;
    ctx.save();
    ctx.translate(x, y);
    ctx.rotate(dir * (0.75 + wob));
    const lg = ctx.createLinearGradient(0,0,size,0);
    lg.addColorStop(0, 'rgba(20,100,70,0.0)');
    lg.addColorStop(0.35, 'rgba(70,190,130,0.65)');
    lg.addColorStop(1, 'rgba(170,255,215,0.15)');
    ctx.fillStyle = lg;

    ctx.beginPath();
    ctx.moveTo(0, 0);
    ctx.quadraticCurveTo(size*0.55, -size*0.35, size, 0);
    ctx.quadraticCurveTo(size*0.55, size*0.35, 0, 0);
    ctx.closePath();
    ctx.fill();
    ctx.restore();
  }

  function drawPetals(f, tipX, tipY, bloom, time) {
    const open = bloom;
    const wob = Math.sin(time * f.swaySpeed + f.phase) * 0.12;

    // subtle glow behind flower
    ctx.save();
    ctx.globalAlpha = 0.08 * open;
    ctx.fillStyle = f.petalB;
    ctx.beginPath();
    ctx.arc(tipX, tipY, (f.petalLen * 1.8) * open, 0, Math.PI*2);
    ctx.fill();
    ctx.restore();

    for (let i=0;i<f.petalCount;i++) {
      const a = (i / f.petalCount) * Math.PI * 2 + wob;
      const len = f.petalLen * (0.35 + 0.65*open);
      const wid = f.petalWid * (0.35 + 0.65*open);

      const px = tipX + Math.cos(a) * len;
      const py = tipY + Math.sin(a) * len;

      const pg = ctx.createLinearGradient(tipX, tipY, px, py);
      pg.addColorStop(0, f.petalC);
      pg.addColorStop(0.55, f.petalB);
      pg.addColorStop(1, f.petalA);

      ctx.fillStyle = pg;
      ctx.save();
      ctx.translate(tipX, tipY);
      ctx.rotate(a);
      ctx.beginPath();
      ctx.moveTo(0, 0);
      ctx.quadraticCurveTo(len*0.55, -wid, len, 0);
      ctx.quadraticCurveTo(len*0.55, wid, 0, 0);
      ctx.closePath();
      ctx.globalAlpha = 0.92;
      ctx.fill();
      ctx.restore();
    }

    const r = Math.max(3, f.petalWid * 0.55) * (0.55 + 0.45*open);
    const cg = ctx.createRadialGradient(tipX - r*0.2, tipY - r*0.2, 1, tipX, tipY, r*1.2);
    cg.addColorStop(0, 'rgba(255,255,255,0.85)');
    cg.addColorStop(0.2, f.centerColor);
    cg.addColorStop(1, 'rgba(120,80,20,0.35)');
    ctx.fillStyle = cg;
    ctx.beginPath();
    ctx.arc(tipX, tipY, r, 0, Math.PI*2);
    ctx.fill();
  }

  // small firefly particles (subtle in day)
  const sparks = Array.from({length: 40}, () => ({
    x: rand(0, innerWidth),
    y: rand(0, innerHeight),
    r: rand(0.6, 1.6),
    vx: rand(-0.10, 0.10),
    vy: rand(-0.08, 0.08),
    p: rand(0, Math.PI*2),
  }));

  function drawSparks(time) {
    for (const s of sparks) {
      s.x += s.vx; s.y += s.vy;
      if (s.x < -20) s.x = innerWidth + 20;
      if (s.x > innerWidth + 20) s.x = -20;
      if (s.y < -20) s.y = innerHeight + 20;
      if (s.y > innerHeight + 20) s.y = -20;

      const tw = 0.35 + 0.65 * (0.5 + 0.5*Math.sin(time*1.6 + s.p));
      ctx.globalAlpha = 0.06 * tw;
      ctx.fillStyle = 'rgba(255,255,255,1)';
      ctx.beginPath();
      ctx.arc(s.x, s.y, s.r, 0, Math.PI*2);
      ctx.fill();
    }
    ctx.globalAlpha = 1;
  }

  // --- Clouds (soft drifting puffs) ---
  const clouds = Array.from({ length: 9 }, () => ({
    x: rand(-200, innerWidth + 200),
    y: rand(innerHeight * 0.05, innerHeight * 0.38),
    s: rand(0.8, 1.9),
    v: rand(8, 22),     // left->right drift
    a: rand(0.18, 0.32),
  }));

  function drawCloud(x, y, s, alpha) {
    ctx.save();
    ctx.globalAlpha = alpha;

    const r = 34 * s;
    const g = ctx.createRadialGradient(x, y, r * 0.2, x, y, r * 2.2);
    g.addColorStop(0, 'rgba(255,255,255,0.95)');
    g.addColorStop(0.6, 'rgba(255,255,255,0.55)');
    g.addColorStop(1, 'rgba(255,255,255,0)');

    ctx.fillStyle = g;

    const puffs = [
      { dx: -52*s, dy:  6*s, rr: 1.05 },
      { dx: -20*s, dy: -16*s, rr: 1.20 },
      { dx:  18*s, dy: -18*s, rr: 1.25 },
      { dx:  54*s, dy:  2*s, rr: 1.10 },
      { dx:  10*s, dy:  10*s, rr: 1.35 },
    ];

    for (const p of puffs) {
      ctx.beginPath();
      ctx.arc(x + p.dx, y + p.dy, r * p.rr, 0, Math.PI * 2);
      ctx.fill();
    }

    ctx.restore();
    ctx.globalAlpha = 1;
  }

  function drawClouds(dt) {
    for (const c of clouds) {
      c.x += c.v * dt;

      const pad = 260 * c.s;
      if (c.x > innerWidth + pad) c.x = -pad;

      drawCloud(c.x, c.y, c.s, c.a);
    }
  }

  resize();

  let last = performance.now();
  function frame(now) {
    const dt = Math.min(0.033, (now - last) / 1000);
    last = now;
    const time = now / 1000;

    paintBackground();
    drawClouds(dt);
    drawSparks(time);

    for (const f of flowers) {
      f.growth = clamp(f.growth + dt * (0.22 + 0.18*f.z), 0, 1);
      if (f.growth > 0.65) {
        f.bloom = clamp(f.bloom + dt * (0.35 + 0.25*f.z), 0, 1);
      }

      const { tipX, tipY } = drawStem(f, f.growth, time);
      if (f.bloom > 0) drawPetals(f, tipX, tipY, f.bloom, time);

      if (f.bloom > 0.85 && Math.random() < 0.012) {
        sparks.push({
          x: tipX + rand(-18,18),
          y: tipY + rand(-18,18),
          r: rand(0.6, 1.2),
          vx: rand(-0.20, 0.20),
          vy: rand(-0.22, 0.05),
          p: rand(0, Math.PI*2),
        });
        if (sparks.length > 75) sparks.splice(0, sparks.length - 75);
      }
    }

    requestAnimationFrame(frame);
  }
  requestAnimationFrame(frame);
})();
</script>
</body>
</html>
